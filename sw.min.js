(()=>{var n={BASE_CACHE_FILES:["/index.html","/index.json","/site.webmanifest","/favicon.ico","/img/avatar/avatar.jpg","/img/lazy-loading.png","/img/not-found.png","/img/header-background/01.jpg","/img/header-background/02.jpg","/fonts/montserrat-v25-latin-700.woff2","/fonts/ubuntu-v20-latin-700.woff2","/fonts/ubuntu-v20-latin-regular.woff2","/fonts/ubuntu-v20-latin-italic.woff2","/svg/logo/logo.svg","/svg/sprites/meta-sprite.svg","/svg/sprites/misc-sprite_v5_5.svg","/svg/sprites/social-sprite.svg","/suchen/index.html","/css/styles_v5_14.css"],OFFLINE_CACHE_FILES:["/nicht-verbunden/index.html","/img/offline.jpg","/css/styles_v5_14.css"],NOT_FOUND_CACHE_FILES:["/nicht-gefunden/index.html","/img/teller_leer.jpg","/css/styles_v5_14.css"]},t=5.14,u=n.BASE_CACHE_FILES,l=n.OFFLINE_CACHE_FILES,a=n.NOT_FOUND_CACHE_FILES,c="/nicht-verbunden/index.html",r="/nicht-gefunden/index.html",e={assets:"assets-v"+t,content:"content-v"+t,offline:"offline-v"+t,notFound:"404-v"+t},i={"/":1800,html:1800,json:86400,js:86400,css:86400},o=[e=>e.indexOf("localhost")!==-1,e=>e.indexOf("kommentiere-den.reisko.ch")!==-1],d=["GET"];function s(e){return o.length>0&&!o.filter(t=>typeof t=="function"&&!t(e)).length}function h(e){let t=e.split(".").reverse()[0].split("?")[0];return t.endsWith("/")?"/":t}function m(e){if(typeof e=="string"){let t=h(e);return typeof i[t]=="number"?i[t]:null}else return null}function f(){try{return Promise.all([caches.open(e.assets).then(e=>e.addAll(u)),caches.open(e.offline).then(e=>e.addAll(l)),caches.open(e.notFound).then(e=>e.addAll(a))]).then(()=>self.skipWaiting())}catch(e){console.error(e)}}function p(){let t=Object.keys(e).map(t=>e[t]);return new Promise((e,n)=>{caches.keys().then(e=>legacyKeys=e.filter(e=>!~t.indexOf(e))).then(t=>{t.length?Promise.all(t.map(e=>caches.delete(e))).then(()=>{e()}).catch(e=>{n(e)}):e()}).catch(()=>{n()})})}function g(t){s(t)||caches.open(e.content).then(e=>{e.match(t).then(e=>e?null:fetch(t)).then(n=>n?e.put(t,n.clone()):null)})}self.addEventListener("install",e=>{e.waitUntil(Promise.all([f(),self.skipWaiting()]))}),self.addEventListener("activate",e=>{e.waitUntil(Promise.all([p(),self.clients.claim(),self.skipWaiting()]).catch(t=>{e.skipWaiting()}))}),self.addEventListener("fetch",t=>{t.respondWith(caches.open(e.content).then(n=>n.match(t.request).then(e=>{if(e){let o=e.headers.entries(),s=null;for(let e of o)e[0]==="date"&&(s=new Date(e[1]));if(s){let i=parseInt(((new Date).getTime()-s.getTime())/1e3),o=m(t.request.url);return o&&i>o?new Promise(s=>fetch(t.request.clone()).then(o=>{o?(n.put(t.request,o.clone()),s(o)):s(e)}).catch(()=>{s(e)})).catch(t=>e):e}else return e}else return null}).then(o=>o||fetch(t.request.clone()).then(o=>o.status<400?(~d.indexOf(t.request.method)&&!s(t.request.url)&&n.put(t.request,o.clone()),o):caches.open(e.notFound).then(e=>e.match(r))).then(e=>{if(e)return e}).catch(()=>caches.open(e.offline).then(e=>e.match(c)))).catch(e=>{throw console.error("Error in fetch handler:",e),e})))}),self.addEventListener("message",e=>{if(typeof e.data=="object"&&typeof e.data.action=="string")switch(e.data.action){case"cache":g(e.data.url);break;default:console.log("Unknown action: "+e.data.action);break}})})()