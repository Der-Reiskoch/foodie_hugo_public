(()=>{var v="%s comments are waiting for approval",u="A comment is waiting for approval";var m={read:{method:"GET",interval:6e4},write:{method:"POST"}};var y=(e,t,r)=>{let o=new Object;t.hasOwnProperty("sectionId")&&(o.sid=t.sectionId),t.hasOwnProperty("pageId")&&(o.pid=t.pageId);var n=!0;for(let a in o)o.hasOwnProperty(a)&&(e+=(n?"?":"&")+a+"="+o[a]),n=!1;if(o.hasOwnProperty("sid")&&o.hasOwnProperty("pid")){let a=new XMLHttpRequest;a.open(m.read.method,e),a.onload=()=>{r(a.responseText)},a.send()}else window.logger.error("no sectionId or pageId")},w=y;var b=(e,t,r)=>{let o=new FormData;for(let a in t)o.append(a,t[a]);let n=new XMLHttpRequest;n.open(m.write.method,e),n.onload=()=>{r(n.responseText)},n.send(o)},h=b;var O=function(){let e=["content"];caches.keys().then(t=>Promise.all(t.map(r=>{if(!e.includes(r))return caches.delete(r)})))},f=O;var B=e=>{let t="";return e&&(t=e.replace(/(?:\r\n|\r|\n)/g,"<br>")),t},C=B;var L=e=>{let t=null;return e&&(t=document.createElement("div"),t.className="row",t.innerHTML=e),t},c=L;var A=(e,t,r)=>{let o="";if(e&&r){var n=t?`<a href="${t}" target="_blank" rel="noopener">${e}</a>`:e;o=`<div class="meta"><div class="name">${n}</div><div class="time">${r}</div></div>`}return o},D=A;var E=(e,t,r,o,n)=>{let a="";if(e&&r){var i="";n&&(n.toLowerCase()==="author"&&(i="from-author"),n.toLowerCase()==="to-be-approved"&&(i="to-be-approved"));var d=D(e,t,o);a=`<div class="msg ${i}">${r}</div>`+d}return a},p=E;var $=e=>new Date(Date.now()).toLocaleDateString(e,{year:"numeric",month:"2-digit",day:"2-digit"}),x=$;var M=(e,t,r)=>{if(e>0&&t&&r){var o=e===1?t:r.replace("%s",`${e}`),n=x("de-DE");return p("Der Reiskoch","https://www.der-reiskoch.de",o,n,"to-be-approved")}else return""},I=M;var s=null,k=function(e){let t=document.getElementById("js-comments-output");t.innerHTML="";var r=null;try{r=JSON.parse(e)}catch(i){console.error(i)}if(r){var o=r.comments,n=r.numberOfToBeApprovedComments;if(n>0){var a=I(n,u,v);t.appendChild(c(a))}o&&o.forEach(i=>{var d=p(i.name,i.website,C(i.message),i.date,i.type);t.appendChild(c(d))})}},l=()=>{f();var e=new FormData(s);let t={sectionId:e.get("sid"),pageId:e.get("pid")};w(s.action,t,r=>{k(r)})},F=function(){var e=new FormData(s);return h(s.action,{sid:e.get("sid"),pid:e.get("pid"),name:e.get("name"),email:e.get("email"),website:e.get("website"),msg:e.get("message")},t=>{t&&t.trim()==="OK"?(s.reset(),f(),l()):console.error(t)}),!1};window.addEventListener("load",()=>{s=document.getElementById("js-comments-form");let e=new FormData(s);e.get("sid")&&e.get("pid")&&(l(),setInterval(function(){l()},m.read.interval)),s&&(s.onsubmit=function(){return F()})});})();
