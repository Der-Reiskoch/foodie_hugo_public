(()=>{var v="%s comments are waiting for approval",g="A comment is waiting for approval";var m={read:{method:"GET",interval:6e4},write:{method:"POST"}};var P=function(e,t,r){var o=new Object;t.hasOwnProperty("sectionId")&&(o.sid=t.sectionId),t.hasOwnProperty("pageid")&&(o.pid=t.pageid);var a=!0;for(var i in o)o.hasOwnProperty(i)&&(e+=(a?"?":"&")+i+"="+o[i]),a=!1;if(o.hasOwnProperty("sid")&&o.hasOwnProperty("pid")){var n=new XMLHttpRequest;n.open(m.read.method,e),n.onload=r,n.send()}else console.error("no sectionId or pageId")},w=P;var y=function(e,t,r){var o=new FormData;for(let i in t)o.append(i,t[i]);var a=new XMLHttpRequest;a.open(m.write.method,e),a.onload=r,a.send(o)},h=y;var B=function(){let e=["content"];caches.keys().then(t=>Promise.all(t.map(r=>{if(!e.includes(r))return caches.delete(r)})))},f=B;var I=function(e){var t="";return e&&(t=e.replace(/(?:\r\n|\r|\n)/g,"<br>")),t},C=I;var L=function(e){let t=null;return e&&(t=document.createElement("div"),t.className="row",t.innerHTML=e),t},c=L;function A(e,t,r){let o="";if(e&&r){var a=t?`<a href="${t}" target="_blank" rel="noopener">${e}</a>`:e;o=`<div class="meta"><div class="name">${a}</div><div class="time">${r}</div></div>`}return o}var D=A;function E(e,t,r,o,a){let i="";if(e&&r){var n="";a&&(a.toLowerCase()==="author"&&(n="from-author"),a.toLowerCase()==="to-be-approved"&&(n="to-be-approved"));var d=D(e,t,o);i=`<div class="msg ${n}">${r}</div>`+d}return i}var p=E;var M=function(e){return new Date(Date.now()).toLocaleDateString(e,{year:"numeric",month:"2-digit",day:"2-digit"})},T=M;var $=function(e,t,r){if(e>0&&t&&r){var o=e===1?t:r.replace("%s",e),a=T("de-DE");return p("Der Reiskoch","https://www.der-reiskoch.de",o,a,"to-be-approved")}else return""},x=$;var s=null,F=function(e){let t=document.getElementById("js-comments-output");t.innerHTML="";var r=null;try{r=JSON.parse(e)}catch(n){console.error(n)}if(r){var o=r.comments,a=r.numberOfToBeApprovedComments;if(a>0){var i=x(a,g,v);t.appendChild(c(i))}o&&o.forEach(n=>{var d=p(n.name,n.website,C(n.message),n.date,n.type);t.appendChild(c(d))})}},l=function(){f();var e=new FormData(s);let t={sectionId:e.get("sid"),pageid:e.get("pid")};w(s.action,t,function(){F(this.response)})},N=function(){var e=new FormData(s);return h(s.action,{sid:e.get("sid"),pid:e.get("pid"),name:e.get("name"),email:e.get("email"),website:e.get("website"),msg:e.get("message")},function(){this.response&&this.response.trim()==="OK"?(s.reset(),f(),l()):console.error(this.response)}),!1};window.addEventListener("load",function(e){s=document.getElementById("js-comments-form");let t=new FormData(s);t.get("sid")&&t.get("pid")&&(l(),setInterval(function(){l()},m.read.interval)),s&&(s.onsubmit=function(){return N()})});})();
