(()=>{var g="%s Kommentare warten auf Freigabe",x="Ein Kommentar wartet auf Freigabe",b={read:{url:"https://kommentiere-den.reisko.ch/",method:"GET",interval:6e4},write:{url:"https://kommentiere-den.reisko.ch/",method:"POST"}},v=function(c,h){var f=b.read.url,a=new Object,g,d,e;c.hasOwnProperty("sectionId")&&(a.sid=c.sectionId),c.hasOwnProperty("pageid")&&(a.pid=c.pageid),g=!0;for(d in a)a.hasOwnProperty(d)&&(f+=(g?"?":"&")+d+"="+a[d]),g=!1;a.hasOwnProperty("sid")&&a.hasOwnProperty("pid")?(e=new XMLHttpRequest,e.open(b.read.method,f),e.onload=h,e.send()):console.error("no sectionId or pageId")},q=v,m=function(c,e){var f=b.write.url,d=new FormData,a;for(let a in c)d.append(a,c[a]);a=new XMLHttpRequest,a.open(b.write.method,f),a.onload=e,a.send(d)},i=m,h=function(){var a=["content"];caches.keys().then(b=>Promise.all(b.map(b=>{if(!a.includes(b))return caches.delete(b)})))},d=h,j=function(a){var b="";return a&&(b=a.replace(/(?:\r\n|\r|\n)/g,"<br>")),b},k=j,l=function(b){let a="";return b&&(a=document.createElement("div"),a.className="row",a.innerHTML=b),a},f=l,o,e,r,s,t,u,a,w,c,y;function n(a,b,c){let d="";if(a&&c){var e=b?`<a href="${b}" target="_blank" rel="noopener">${a}</a>`:a;d=`<div class="meta"><div class="name">${e}</div><div class="time">${c}</div></div>`}return d}o=n;function p(f,h,d,g,b){var a,c;let e="";return f&&d&&(a="",b&&(b.toLowerCase()==="author"&&(a="from-author"),b.toLowerCase()==="to-be-approved"&&(a="to-be-approved")),c=o(f,h,g),e=`<div class="msg ${a}">${d}</div>`+c),e}e=p,r=function(a){var b=new Date(Date.now()),c=b.toLocaleDateString(a,{year:"numeric",month:"2-digit",day:"2-digit"});return c},s=r,t=function(a,b,c){if(a>0&&b&&c){var d=a===1?b:c.replace("%s",a),f=s("de-DE");return e("Der Reiskoch","http://der.reisko.ch",d,f,"to-be-approved")}return""},u=t,a=null,w=function(i){var a,c,d,h;let b=document.getElementById("cwrap");b.innerHTML="",a=null;try{a=JSON.parse(i)}catch(a){console.error(a)}a&&(c=a.comments,d=a.numberOfToBeApprovedComments,d>0&&(h=u(d,x,g),b.appendChild(f(h))),c&&c.forEach(a=>{var a=e(a.name,a.website,k(a.message),a.date,a.type);b.appendChild(f(a))}))},c=function(){d();var b=new FormData(a);let c={sectionId:b.get("sid"),pageid:b.get("pid")};q(c,function(){w(this.response)})},y=function(){var b=new FormData(a);return i({sid:b.get("sid"),pid:b.get("pid"),name:b.get("name"),email:b.get("email"),website:b.get("website"),msg:b.get("message")},function(){this.response&&this.response.trim()==="OK"?(a.reset(),d(),c()):console.error(this.response)}),!1},window.addEventListener("load",function(d){a=document.getElementById("js-comments-form"),formData=new FormData(a),formData.get("sid")&&formData.get("pid")&&(c(),setInterval(function(){c()},b.read.interval)),a&&(a.onsubmit=function(){return y(this)})})})()