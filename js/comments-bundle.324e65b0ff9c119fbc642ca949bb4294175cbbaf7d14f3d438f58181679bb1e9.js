(()=>{var g="%s Kommentare warten auf Freigabe",k="Ein Kommentar wartet auf Freigabe",C={url:"https://kommentiere-den.reisko.ch/v2.php",method:"GET",interval:6e4},x={url:"https://kommentiere-den.reisko.ch/",method:"POST"},e={read:C,write:x},O=function(t,n){var o,i,a,r=e.read.url,s=new Object;t.hasOwnProperty("sectionId")&&(s.sid=t.sectionId),t.hasOwnProperty("pageid")&&(s.pid=t.pageid),i=!0;for(a in s)s.hasOwnProperty(a)&&(r+=(i?"?":"&")+a+"="+s[a]),i=!1;s.hasOwnProperty("sid")&&s.hasOwnProperty("pid")?(o=new XMLHttpRequest,o.open(e.read.method,r),o.onload=n,o.send()):console.error("no sectionId or pageId")},d=O,l=function(t,n){var s,i=e.write.url,o=new FormData;for(let e in t)o.append(e,t[e]);s=new XMLHttpRequest,s.open(e.write.method,i),s.onload=n,s.send(o)},f=l,b=function(){var e=["content"];caches.keys().then(t=>Promise.all(t.map(t=>{if(!e.includes(t))return caches.delete(t)})))},i=b,u=function(e){var t="";return e&&(t=e.replace(/(?:\r\n|\r|\n)/g,"<br>")),t},h=u,m=function(e){let t="";return e&&(t=document.createElement("div"),t.className="row",t.innerHTML=e),t},c=m;function p(e,t,n){let s="";if(e&&n){var o=t?`<a href="${t}" target="_blank" rel="noopener">${e}</a>`:e;s=`<div class="meta"><div class="name">${o}</div><div class="time">${n}</div></div>`}return s}r=p;function v(e,t,n,s,o){let a="";if(e&&n){var c,i="";o&&(o.toLowerCase()==="author"&&(i="from-author"),o.toLowerCase()==="to-be-approved"&&(i="to-be-approved")),c=r(e,t,s),a=`<div class="msg ${i}">${n}</div>`+c}return a}var r,a=v,j=function(e){var t=new Date(Date.now()),n=t.toLocaleDateString(e,{year:"numeric",month:"2-digit",day:"2-digit"});return n},y=j,_=function(e,t,n){if(e>0&&t&&n){var s=e===1?t:n.replace("%s",e),o=y("de-DE");return a("Der Reiskoch","http://der.reisko.ch",s,o,"to-be-approved")}return""},w=_,s=null,n=null,t=null,E=function(e){let n=document.getElementById("cwrap");n.innerHTML="",t=null;try{t=JSON.parse(e)}catch(e){console.error(e)}if(t){var t,i,s=t.comments,o=t.numberOfToBeApprovedComments;o>0&&(i=w(o,k,g),n.appendChild(c(i))),s&&s.forEach(e=>{var e=a(e.name,e.website,h(e.message),e.date,e.type);n.appendChild(c(e))})}},o=function(){i();let e={sectionId:s.value,pageid:n.value};d(e,function(){E(this.response)})},A=function(){return f({sid:s.value,pid:n.value,name:document.getElementById("cname").value,email:document.getElementById("cmail").value,website:document.getElementById("cwebsite").value,msg:document.getElementById("cmsg").value},function(){this.response&&this.response.trim()==="OK"?(t.reset(),i(),o()):console.error(this.response)}),!1};window.addEventListener("load",function(){s=document.getElementById("sid"),n=document.getElementById("pid"),t=document.getElementById("js-comments-form"),s&&n&&(o(),setInterval(function(){o()},e.read.interval)),t&&(t.onsubmit=function(){return A(this)})})})()